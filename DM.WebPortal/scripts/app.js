!function(){"use strict";angular.module("app",["ngRoute","ngAnimate","ngAria","ui.bootstrap","ui.bootstrap.modal","ngTagsInput","textAngular","angular-loading-bar","duScroll","ngDropzone","ngDialog","ngecharts","ui.ace","app.nav","app.i18n","app.page"]).constant("USER_ROLES",{all:"*",admin:"Admin",user:"User"}).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("AppConfig",{restServerUrl:"http://localhost",restServicePort:8e3,oAuthProviderNamesCommaSeparatedList:"",captcha:!1,adAuthEnabled:!0,SecureRoutes:["browser/dynamic","browser/responsive","browser/static","admin/setup","admin/dataSource"]})}(),function(){"use strict";angular.module("appShared",[])}(),function(){"use strict";angular.module("app.ui.form",[])}(),function(){"use strict";angular.module("app.ui.form.validation",["validation.match"])}(),function(){"use strict";angular.module("app.nav",[])}(),function(){"use strict";angular.module("app.page",["appShared"])}(),angular.module("app").factory("AilService",["$http","$q","$rootScope","AppConfig","AppSessionService",function($http,$q,$rootScope,AppConfig,AppSessionService){var $ctrl=this;return $ctrl.appConfig=AppConfig,$ctrl.appSessionService=AppSessionService,console.log("create ailService"),{createQueryString:function(obj){var str=[];for(var p in obj)obj.hasOwnProperty(p)&&str.push(encodeURIComponent(p)+"="+encodeURIComponent(obj[p]));return str.join("&")},getApi:function(topic){var restUrlPath=AppConfig.restServerUrl+":"+AppConfig.restServicePort+"/api/"+topic;return console.info("getting url: "+restUrlPath),restUrlPath},getPostUrl:function(topic){return console.log("getting: test url for topic: "+topic),this.getApi("EndPoint/"+topic)},getPostAuthUrl:function(topic){return console.log("getting: test auth url for topic: "+topic),this.getApi("EndPointAuth/"+topic)},getMessages:function(topic,cutoffDate){console.log("getMessages",topic);var request=$http({method:"get",url:this.getApi("messages/"+topic+"?cutoffDate="+cutoffDate)});return request.then(this.handleSuccess,this.handleError)},getMessage:function(id){console.log("getMessage",id);var request=$http({method:"get",url:this.getApi("message/"+id)});return request.then(this.handleSuccess,this.handleError)},ClearQueueLock:function(msg){console.log("ClearQueueLock",msg);var request=$http({method:"post",url:this.getApi("ClearQueueLock"),contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(msg)});return request.then(this.handleSuccess,this.handleError)},CancelQueue:function(msg){console.log("CancelQueue",msg);var request=$http({method:"post",url:this.getApi("CancelQueue"),contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(msg)});return request.then(this.handleSuccess,this.handleError)},Cancel:function(msg){console.log("Cancel",msg);var request=$http({method:"post",url:this.getApi("Cancel"),contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(msg)});return request.then(this.handleSuccess,this.handleError)},stringToAsciiByteArray:function(str){for(var bytes=[],i=0;i<str.length;++i){var charCode=str.charCodeAt(i);if(charCode>255)throw new Error("Character "+String.fromCharCode(charCode)+" can't be represented by a US-ASCII byte.");bytes.push(charCode)}return bytes},CompileScript:function(name,theScript){console.log("CompileScript",name);var request=$http({method:"post",url:this.getApi("CompileScript2/"+name),headers:{"Content-Type":"application/json"},dataType:"json",data:JSON.stringify(theScript)});return request.then(this.handleSuccess,this.handleError)},getSummary:function(){var request=$http({method:"GET",url:this.getApi("Messages/Summary")});return request.then(this.handleSuccess,this.handleError)},getExpiredQueues:function(){var request=$http({method:"GET",url:this.getApi("ExpiredQueues")});return request.then(this.handleSuccess,this.handleError)},getQueues:function(){var request=$http({method:"GET",url:this.getApi("Queues")});return request.then(this.handleSuccess,this.handleError)},cancelMessage:function(id){console.log("cancelMessage",id);var request=$http({method:"post",url:this.getApi("Messages/Cancel"),data:JSON.stringify(id)});return request.then(this.handleSuccess,this.handleError)},resendMessage:function(id){console.log("resendMessage",id);var request=$http({method:"post",url:this.getApi("Message/Resend"),data:id});return request.then(this.handleSuccess,this.handleError)},deleteState:function(itm){var url=encodeURI("State?itemKey="+itm.Item+"&value="+itm.StateValue);console.log(url);var request=$http({method:"delete",url:this.getApi(url),headers:{"Content-Type":"application/json"}});return request.then(this.handleSuccess,this.handleError)},getOrGetState:function(itm){var url=encodeURI("State?itemKey="+itm.Item+"&value="+itm.StateValue);console.log(url);var request=$http({method:"post",url:this.getApi(url),headers:{"Content-Type":"application/json"}});return request.then(this.handleSuccess,this.handleError)},findStates:function(searchKey,searchValue){console.log("findStates: ="+searchKey+" val="+searchValue);var url="State/?";searchKey&&(url=url+"find="+searchKey+"&"),searchValue&&(url=url+"value="+searchValue+"&");var request=$http({method:"get",url:this.getApi(url),dataType:"json"});return request.then(this.handleSuccess,this.handleError)},setMessageListState:function(rq){console.log("setMessageListState",rq);var request=$http({method:"post",url:this.getApi("SetMessageListState"),headers:{"Content-Type":"application/json"},data:JSON.stringify(rq)});return request.then(this.handleSuccess,this.handleError)},createMessage:function(msg){console.log("createMessage",msg);var request=$http({method:"post",url:this.getApi("CreateMessage"),headers:{"Content-Type":"application/json"},data:JSON.stringify(msg)});return request.then(this.handleSuccess,this.handleError)},UserLogin:function(token){var request=$http({method:"get",headers:{Authorization:"Basic "+token,"Content-Type":"application/json"},url:this.getApi("User")});return console.log("UserLogin: ["+token+"]"),request.then(this.handleSuccess,this.handleError)},EndPointScriptPAuth:function(scriptName,token,data){var request=$http({method:"post",headers:{Authorization:"Basic "+token,"Content-Type":"application/json"},url:this.getPostAuthUrl(scriptName),data:data});return console.log("POST-SECURE: ["+this.getPostAuthUrl(scriptName)+"] SCRIPT:"+scriptName+" DATA:"+data+" TOKEN: "+token),request.then(this.handleSuccess,this.handleError)},EndPointScriptP:function(scriptName,data){console.log("POST: "+scriptName+" DATA:"+data);var request=$http({method:"post",headers:{"Content-Type":"application/json"},dataType:"json",url:this.getPostUrl(scriptName),data:JSON.parse(data)});return request.then(this.handleSuccess,this.handleError)},EndPointScriptFormP:function(scriptName,data){var contextData=data;contextData||(contextData="");var request=$http({method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded,  charset=UTF-8;"},data:contextData,url:this.getPostUrl(scriptName)});return console.log("POST-XXX-FORM-URLENCODED: "+scriptName+" DATA:"+data),request.then(this.handleSuccess,this.handleError)},EndPointScriptG:function(scriptName,data){var qs=encodeURIComponent(JSON.stringify(data)),request=$http({method:"get",url:this.getPostUrl(scriptName)+"?ctx="+qs,data:data});return request.then(this.handleSuccess,this.handleError)},getEndpointScripts:function(){console.log("getEndpointScripts","get endpoint scripts called");var request=$http({method:"GET",url:this.getApi("scripts/production/Endpoint")});return request.then(this.handleSuccess,this.handleError)},getScript:function(id){console.log("getAllScripts","get all scripts scripts called");var request=$http({method:"GET",url:this.getApi("Scripts/"+id)});return request.then(this.handleSuccess,this.handleError)},getAllScripts:function(){console.log("getAllScripts","get all scripts scripts called");var request=$http({method:"GET",url:this.getApi("scripts/production/All")});return request.then(this.handleSuccess,this.handleError)},getTaskScripts:function(){console.log("getEventScripts","get event scripts called");var request=$http({method:"GET",url:this.getUrl("scripts/production/Task")});return request.then(this.handleSuccess,this.handleError)},getLogMessages:function(severity,category){var url="Logs/?";severity&&(url=url+"severity="+severity+"&"),category&&(url=url+"category="+category+"&");var request=$http({method:"GET",url:this.getApi(url)});return request.then(this.handleSuccess,this.handleError)},getNotifications:function(){console.log("getNotification","getNotification for all messages");var request=$http({method:"GET",url:this.getApi("NotificationConfig")});return request.then(this.handleSuccess,this.handleError)},setNotifications:function(config){console.log("setNotification","NotificationConfig POST DATA:"+config);var request=$http({method:"POST",headers:{"Content-Type":"application/json"},dataType:"json",url:this.getApi("NotificationConfig"),data:JSON.stringify(config)});return request.then(this.handleSuccess,this.handleError)},getDatasources:function(){console.log("getDatasources","getDatasources for all messages");var request=$http({method:"GET",url:this.getApi("Datasources")});return request.then(this.handleSuccess,this.handleError)},getAllStats:function(){console.log("getAllStats","getAllStats for all messages");var request=$http({method:"GET",url:this.getApi("Scripts/Stats")});return request.then(this.handleSuccess,this.handleError)},compile:function(){console.log("compile","compile dispatch manager scripts");var myPromise=$q.defer();return $http({method:"POST",url:this.getApi("compile")}).success(function(data,status){myPromise.resolve(data)}).error(function(data,status){myPromise.reject(data)}),myPromise.promise},stopTask:function(taskName){console.log("stopTask","Stop AIL task :"+taskName);var cmd="Scripts/Stop/"+taskName,request=$http({method:"GET",url:this.getApi(cmd)});return request.then(this.handleSuccess,this.handleError)},enableScript:function(taskName){console.log("enableScript","Task script action:"+taskName);var cmd="Scripts/Enable/"+taskName,request=$http({method:"GET",url:this.getApi(cmd)});return request.then(this.handleSuccess,this.handleError)},disableScript:function(taskName){console.log("disableScript","Task script action:"+taskName);var cmd="Scripts/Disable/"+taskName,request=$http({method:"GET",url:this.getApi(cmd)});return request.then(this.handleSuccess,this.handleError)},startTask:function(taskName){console.log("startTask","Task script action:"+taskName);var cmd="Scripts/Start/"+taskName,request=$http({method:"GET",url:this.getApi(cmd)});return request.then(this.handleSuccess,this.handleError)},pauseTask:function(taskName){console.log("pauseTask","Task script action:"+taskName);var cmd="Scripts/Pause/"+taskName,request=$http({method:"GET",url:this.getApi(cmd)});return request.then(this.handleSuccess,this.handleError)},handleSuccess:function(response){return $rootScope.$broadcast("$SERVER_GOOD"),response.data},handleError:function(response){if(!angular.isObject(response.data)||!response.data.message){if(response.data)return $rootScope.$broadcast("$SERVER_ERROR",response.data),{success:!1,serverError:!0,message:response.data};if(response.statusText)return $rootScope.$broadcast("$SERVER_ERROR",response.statusText),{success:!1,serverError:!0,message:response.statusText};var msg="AiL Server unavailable.  Reason not supplied...check your network connection.";return $rootScope.$broadcast("$SERVER_ERROR",msg),{success:!1,serverError:!0,message:msg}}return response.data.message}}}]),function(){"use strict";function restApi($http,AppConfig){return{niceUrl:function(baseUrl,resource){0===resource.indexOf("/",0)&&(resource=resource.substr(1,resource.length));var resourceEndsWithSlash=resource.indexOf("/",resource.length-1)!==-1;resourceEndsWithSlash&&(resource=resource.substr(0,resource.length-1));var serviceBaseUrlEndsWithSlash=baseUrl.indexOf("/",baseUrl.length-1)!==-1;return serviceBaseUrlEndsWithSlash?baseUrl+resource:baseUrl+"/"+resource},get:function(url,callback){$http.get(url).success(function(result,status,headers,config){if(result&&"null"===result&&(result=null),callback)return void callback(null,result)}).error(function(result,status,headers,config){callback&&("string"==typeof result?callback(result,null):callback(JSON.stringify(result),null))})},getWithHeaders:function(url,headers,callback){$http.get(url,{headers:headers}).success(function(result,status,headers,config){if(result&&"null"===result&&(result=null),callback)return void callback(null,result)}).error(function(result,status,headers,config){callback&&("string"==typeof result?callback(result,null):callback(JSON.stringify(result),null))})},post:function(url,data,callback){$http.post(url,data).success(function(result,status,headers,config){if(result&&"null"===result&&(result=null),callback)return void callback(null,result)}).error(function(result,status,headers,config){callback&&("string"==typeof result?callback(result,null):callback(JSON.stringify(result),null))})},postWithHeaders:function(url,data,headers,callback){$http.post(url,data,{headers:headers}).success(function(result,status,headers,config){if(result&&"null"===result&&(result=null),callback)return void callback(null,result)}).error(function(result,status,headers,config){callback&&("string"==typeof result?callback(result,null):callback(JSON.stringify(result),null))})},"delete":function(url,callback){$http["delete"](url).success(function(result,status,headers,config){if(result&&"null"===result&&(result=null),callback)return void callback(null,result)}).error(function(result,status,headers,config){callback&&("string"==typeof result?callback(result,null):callback(JSON.stringify(result),null))})},deleteWithHeaders:function(url,headers,callback){$http["delete"](url,{headers:headers}).success(function(result,status,headers,config){if(result&&"null"===result&&(result=null),callback)return void callback(null,result)}).error(function(result,status,headers,config){callback&&("string"==typeof result?callback(result,null):callback(JSON.stringify(result),null))})}}}function alertService(){var me=this;return this.alertObj={show:!1,msg:"",type:"alert-success"},this.alertShow=!1,this.alertTypes=["alert-success","alert-info","alert-warning","alert-danger"],this.alert=function(type,msg,cssClassList,label){this.alertObj.msg=msg,this.alertObj.type=me.alertTypes[type],this.alertObj.show=!0,this.alertObj.label=label,this.alertObj.cssClassList=cssClassList},this.success=function(msg){this.alert(0,msg,"alert alert-success fade in radius-bordered alert-shadowed","Warning")},this.info=function(msg){this.alert(1,msg,"alert alert-info fade in radius-bordered alert-shadowed","Info")},this.warning=function(msg){this.alert(2,msg,"alert alert-warning fade in radius-bordered alert-shadowed","Warning")},this.danger=function(msg){this.alertShow=!0,this.alert(3,msg,"alert alert-danger fade in radius-bordered alert-shadowed","Danger")},this.hide=function(){console.log("hiding"),this.alertObj.show=!1},this}function alert(alertService){return{restrict:"AE",link:function(scope,e,a,ctl){scope.alert=alertService.alertObj},template:"<div>{{alert.msg}}</div>"}}function uiNotCloseOnClick(){return{restrict:"A",compile:function(ele,attrs){return ele.on("click",function(event){return event.stopPropagation()})}}}function blink($timeout){return{restrict:"AE",transclude:!0,scope:{enable:"@blinkEnable",forecolor:"@blinkForecolor",backcolor:"@blinkBackcolor",rate:"@blinkRate"},controller:function($scope,$element){function showElement(){$element.css("background-color",backColor),$element.css("color",foreColor),$timeout(hideElement,rate)}function hideElement(){$element.css("background-color",""),$element.css("color",""),$timeout(showElement,rate)}var foreColor="white",backColor="red",rate=1e3;$scope.forecolor&&(foreColor=$scope.forecolor),$scope.backcolor&&(backColor=$scope.backcolor),$scope.rate&&(rate=parseInt($scope.rate)),"true"==$scope.enable&&showElement()},template:"<span ng-transclude></span>",replace:!0}}angular.module("appShared").factory("restApi",["$http","AppConfig",restApi]).service("alertService",[alertService]).directive("alert",["alertService",alert]).directive("uiNotCloseOnClick",uiNotCloseOnClick).directive("blink",["$timeout",blink])}(),function(){"use strict";function AppSessionService($rootScope,$window,AUTH_EVENTS){var sessionCached=$window.sessionStorage.SessionState;return null!=sessionCached?(console.info("session is cached...restore session"),$rootScope.sessionState=JSON.parse(sessionCached)):(console.error("no session not found...create new session"),$rootScope.sessionState={},$rootScope.sessionState.BearerToken=null,$rootScope.sessionState.UserData=null,$rootScope.sessionState.Lookup=null),$rootScope.setBearerToken=function(stateObject){console.log("app.Controller -> setBearerToken()"),$rootScope.sessionState.BearerToken=stateObject,$window.sessionStorage.SessionState=JSON.stringify($rootScope.sessionState),console.info($rootScope.sessionState)},$rootScope.getUserData=function(stateObject){return console.log("app.Controller -> setUserData()"),$rootScope.sessionState.UserData},$rootScope.setUserData=function(stateObject){console.log("app.Controller -> setUserData()"),$rootScope.sessionState.UserData=stateObject,$window.sessionStorage.SessionState=JSON.stringify($rootScope.sessionState),console.info($rootScope.sessionState)},$rootScope.clearSession=function(){console.log("app.Controller -> clearSession()"),$rootScope.sessionState={},$window.sessionStorage.removeItem("SessionState")},{GetLookupData:function(){return $rootScope.LookupData},SetLookupData:function(data){$rootScope.LookupData=data},SetConnectionToken:function(token){$rootScope.setBearerToken(token.access_token)},GetBearerToken:function(){return $rootScope.sessionState.BearerToken},SetUserData:function(userData){$rootScope.setUserData(userData),$rootScope.$broadcast(AUTH_EVENTS.loginSuccess)},GetUserData:function(){return $rootScope.getUserData()},SetKioskMode:function(mode){$window.sessionStorage.mode=JSON.stringify(mode)},GetKioskMode:function(){return $window.sessionStorage.mode?JSON.parse($window.sessionStorage.mode):(this.SetKioskMode(!1),!1)},SetFilter:function(filter){$window.sessionStorage.filter=JSON.stringify(filter)},GetFilter:function(){if($window.sessionStorage.filter)return JSON.parse($window.sessionStorage.filter);var defaultFilter={sourceItems:[],targetItems:[]};return this.SetFilter(defaultFilter),defaultFilter},IsAuthenticated:function(){return!!$window.sessionStorage.SessionState},HasPriv:function(privName){var userData=this.GetUserData();return!!userData&&(!!userData.Permissions&&userData.Permissions.indexOf(privName)>=0)},IsNotAuthenticated:function(){return!this.isAuthenticated()},IsAuthorized:function(authorizedRoles){if(angular.isArray(authorizedRoles)||(authorizedRoles=[authorizedRoles]),!authService.isAuthenticated())return!1;for(var i=0;i<JSON.parse($window.sessionStorage.SessionState).roles.length;i++)if(authorizedRoles.indexOf(JSON.parse($window.sessionStorage.SessionState).roles[i])!=-1)return!0;return!1},IsNotAuthorized:function(authorizedRoles){return!this.isAuthorized(authorizedRoles)},Logout:function(){$window.sessionStorage.removeItem("SessionState"),$rootScope.sessionState={},$rootScope.$broadcast(AUTH_EVENTS.logoutSuccess)}}}angular.module("appShared").factory("AppSessionService",["$rootScope","$window","AUTH_EVENTS",AppSessionService])}(),function(){"use strict";function AppCtrl($scope,$rootScope,$route,$document,$window,$location,AppSessionService,AppConfig,AilService,AUTH_EVENTS){function parseURL(url){var queries,split,i,parser=document.createElement("a"),searchObject={};for(parser.href=url,"9009"==parser.port||"80"==parser.port?parser.port=AppConfig.restServicePort:parser.port=parseInt(parser.port),queries=parser.search.replace(/^\?/,"").split("&"),i=0;i<queries.length;i++)split=queries[i].split("="),searchObject[split[0]]=split[1];return{protocol:parser.protocol,host:parser.host,hostname:parser.hostname,port:parser.port,pathname:parser.pathname,search:parser.search,searchObject:searchObject,hash:parser.hash}}var date=new Date,year=date.getFullYear();$scope.main={brand:"AiL Manage",name:"Vegas",year:year},$scope.vm={},$scope.vm.controller="AppCtrl",$scope.vm.sourceLocations=[],$scope.vm.targetLocations=[],$scope.cancelEvent=function($event){$event.stopPropagation()},$scope.vm.isLoggedIn=AppSessionService.IsAuthenticated(),$scope.vm.hasScriptPriv=AppSessionService.HasPriv("script"),$scope.vm.hasMessage=AppSessionService.HasPriv("message"),$scope.vm.hasAdminPriv=AppSessionService.HasPriv("admin");var appData=AppSessionService.GetUserData();null!=appData?$scope.vm.Name=appData.FirstName+" "+appData.LastName:$scope.vm.Name="",$rootScope.$on("$SERVER_GOOD",function(){$scope.vm.errorMessage=null}),$rootScope.$on("$SERVER_ERROR",function(event,args){$scope.vm.errorMessage=args}),$scope.closeWindow=function(){status.isopenSettings=!0},$scope.pageTransitionOpts=[{name:"Fade up","class":"animate-fade-up"},{name:"Scale up","class":"ainmate-scale-up"},{name:"Slide in from right","class":"ainmate-slide-in-right"},{name:"Flip Y","class":"animate-flip-y"}],$scope.admin={layout:"wide",menu:"vertical",fixedHeader:!0,fixedSidebar:!1,pageTransition:$scope.pageTransitionOpts[0],skin:"12",sourceLocationsSelected:[],targetLocationsSelected:[]},$scope.$watch("admin",function(newVal,oldVal){console.log("newVal change: "+newVal.menu),"horizontal"===newVal.menu&&"vertical"===oldVal.menu&&$rootScope.$broadcast("nav:reset"),newVal.fixedHeader===!1&&newVal.fixedSidebar===!0&&(oldVal.fixedHeader===!1&&oldVal.fixedSidebar===!1&&($scope.admin.fixedHeader=!0,$scope.admin.fixedSidebar=!0),oldVal.fixedHeader===!0&&oldVal.fixedSidebar===!0&&($scope.admin.fixedHeader=!1,$scope.admin.fixedSidebar=!1)),newVal.fixedSidebar===!0&&($scope.admin.fixedHeader=!0),newVal.fixedHeader===!1&&($scope.admin.fixedSidebar=!1),newVal.kioskMode!=oldVal.kioskMode&&($scope.admin.kioskMode=newVal.kioskMode,$rootScope.$broadcast("$kioskModeChange",{mode:$scope.admin.kioskMode}));for(var sourceLocations=[],i=0;i<newVal.sourceLocationsSelected.length;i++)sourceLocations.push(newVal.sourceLocationsSelected[i].Id);for(var targetLocations=[],i=0;i<newVal.targetLocationsSelected.length;i++)destLocations.push(newVal.targetLocationsSelected[i].Id);var filterSetting={sourceItems:sourceLocations,targetItems:targetLocations};AppSessionService.SetFilter(filterSetting),$rootScope.$broadcast("$filterChange",filterSetting)},!0),$scope.color={primary:"#5B90BF",success:"#A3BE8C",info:"#7FABD2",infoAlt:"#B48EAD",warning:"#EBCB8B",danger:"#BF616A",gray:"#DCDCDC"},$scope.onLogout=function(){AppSessionService.Logout()},$rootScope.$on("$locationChangeStart",function(event,next,current){try{AppConfig.SecureRoutes.forEach(function(item){if(next.indexOf(item)!=-1&&!AppSessionService.IsAuthenticated())throw alert("You need to be authenticated to see this page!"),event.preventDefault(),BreakException})}catch(e){if(e!==BreakException)throw e}}),$scope.refreshModel=function(loginStatus){$scope.vm.isLoggedIn=loginStatus,$scope.vm.hasScriptPriv=AppSessionService.HasPriv("script"),$scope.vm.hasMessage=AppSessionService.HasPriv("message")},$scope.determineDefaultHost=function(){var host=$location.protocol()+"://"+$location.host();AppConfig.restServerUrl=host},$scope.onButtonClicked=function(){var host=$scope.vm.remoteHost;host.startsWith("http://")||(host="http://"+host);var url=parseURL(host);AppConfig.restServerUrl=url.protocol+"//"+url.hostname,AppConfig.restServicePort=url.port,$rootScope.$broadcast("$serverNodeChanged")},$rootScope.$on("$routeChangeSuccess",function(event,currentRoute,previousRoute){$document.scrollTo(0,0)}),$rootScope.$on(AUTH_EVENTS.loginSuccess,function(){console.info("login is true"),$scope.refreshModel(!0),$location.path("/"),$scope.vm.isLoggedIn=AppSessionService.IsAuthenticated(),$scope.vm.hasScriptPriv=AppSessionService.HasPriv("script"),$scope.vm.hasMessage=AppSessionService.HasPriv("message"),$scope.vm.hasAdminPriv=AppSessionService.HasPriv("admin");var appData=AppSessionService.GetUserData();null!=appData?$scope.vm.FriendlyName=appData.FriendlyName:$scope.vm.FriendlyName="?"}),$rootScope.$on(AUTH_EVENTS.logoutSuccess,function(){console.info("login is false; goto signin page"),$scope.vm.isLoggedIn=AppSessionService.IsAuthenticated(),$scope.refreshModel(!1),$location.path("/page/signin")}),$scope.determineDefaultHost()}angular.module("app").controller("AppCtrl",["$scope","$rootScope","$route","$document","$window","$location","AppSessionService","AppConfig","AilService","AUTH_EVENTS",AppCtrl])}(),function(){"use strict";angular.module("app").config(["$routeProvider","AppConfig",function($routeProvider,AppConfig){var routes,setRoutes,setSecureRoute;routes=["page/404","page/500","page/blank","page/forgot-password","page/change-password","page/lock-screen","page/profile","page/invoice","page/signin","page/signup","dashboard","queues/queues","datasources/list","states/states","msg/new","msg/messageList","logs/logs","script/scriptList","script/scriptEditor","notifications/notifications","app/tasks","app/calendar"],setRoutes=function(route){var config,url;return url="/"+route,config={templateUrl:"app/"+route+".html"},$routeProvider.when(url,config),$routeProvider},setSecureRoute=function(route){var config,url;return url="/"+route,config={routeName:route,templateUrl:"app/"+route+".html",requireLogin:!0},console.info("secure: "+url),$routeProvider.when(url,config),$routeProvider},AppConfig.SecureRoutes.forEach(function(route){return setSecureRoute(route)}),routes.forEach(function(route){return setRoutes(route)}),$routeProvider.when("/",{redirectTo:"/dashboard"}).when("/dashboard",{templateUrl:"app/dashboard/dashboard.html"}).when("/404",{templateUrl:"app/page/404.html"}).otherwise({redirectTo:"/404"})}])}(),function(){function i18nConfig($translateProvider){$translateProvider.useStaticFilesLoader({prefix:"i18n/",suffix:".json"}),$translateProvider.preferredLanguage("en"),$translateProvider.useSanitizeValueStrategy(null)}function LangCtrl($scope,$translate){$scope.lang="English",$scope.setLang=function(lang){switch(lang){case"English":$translate.use("en");break;case"Español":$translate.use("es");break;case"中文":$translate.use("zh");break;case"日本語":$translate.use("ja");break;case"Portugal":$translate.use("pt");break;case"Русский язык":$translate.use("ru")}return $scope.lang=lang},$scope.getFlag=function(){var lang;switch(lang=$scope.lang){case"English":return"flags-american";case"Español":return"flags-spain";case"中文":return"flags-china";case"Portugal":return"flags-portugal";case"日本語":return"flags-japan";case"Русский язык":return"flags-russia"}}}angular.module("app.i18n",["pascalprecht.translate"]).config(["$translateProvider",i18nConfig]).controller("LangCtrl",["$scope","$translate",LangCtrl])}(),function(){"use strict";function DashboardCtrl($scope,$rootScope,$interval,AilService){$scope.vm={},$scope.vm.summary={},$scope.vm.stats=[],$scope.vm.chartExeOptions={title:{text:"Loading"}},$scope.vm.chartOptions={},$scope.vm.chartUpdate=0,$scope.$on("$locationChangeStart",function(event,next,current){$interval.cancel($scope.intervalId)}),$rootScope.$on("$serverNodeChanged",function(){$scope.refreshData()}),$scope.refreshData=function(){$scope.vm.chartOptions={},AilService.getSummary().then(function(data){console.log(data),$scope.vm.summary=data}),AilService.getAllStats().then(function(data){$scope.vm.stats=data,$scope.pie1.options.series[0].data=[],$scope.vm.stats.forEach(function(item){item.ExecutionCount>0&&$scope.pie1.options.series[0].data.push({value:item.ExecutionCount,name:item.Name})}),$scope.vm.chartOptions=$scope.pie1.options})},$scope.pie1={},$scope.pie1.options={title:{text:"Event Instances",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},toolbox:{show:!0,feature:{restore:{show:!0,title:"restore"},saveAsImage:{show:!0,title:"save as image"}}},calculable:!0,series:[{name:"Message Breakdown",type:"pie",radius:"55%",center:["50%","60%"],data:[0]}]},$scope.refreshData(),$scope.intervalId=$interval($scope.refreshData,1e4),$scope.bar2={},$scope.bar2.options={}}angular.module("app").controller("DashboardCtrl",["$scope","$rootScope","$interval","AilService",DashboardCtrl])}(),function(){"use strict";function DatasourcesCtrl($scope,AilService){$scope.vm={},$scope.getDatasource=function(){console.log("getDataSources: fetch data"),AilService.getDatasources().then(function(data){$scope.vm.Datasources=data})},$scope.getDatasource()}angular.module("app").controller("DatasourcesCtrl",["$scope","AilService",DatasourcesCtrl])}(),function(){"use strict";function TagsDemoCtrl($scope){$scope.tags=["foo","bar"]}function DatepickerDemoCtrl($scope){$scope.today=function(){$scope.dt=new Date},$scope.today(),$scope.clear=function(){$scope.dt=null},$scope.disabled=function(date,mode){return"day"===mode&&(0===date.getDay()||6===date.getDay())},$scope.toggleMin=function(){$scope.minDate=$scope.minDate?null:new Date},$scope.toggleMin(),$scope.maxDate=new Date(2020,5,22),$scope.open1=function(){$scope.popup1.opened=!0},$scope.open2=function(){$scope.popup2.opened=!0},$scope.setDate=function(year,month,day){$scope.dt=new Date(year,month,day)},$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],$scope.format=$scope.formats[0],$scope.altInputFormats=["M!/d!/yyyy"],$scope.popup1={opened:!1},$scope.popup2={opened:!1};var tomorrow=new Date;tomorrow.setDate(tomorrow.getDate()+1);var afterTomorrow=new Date;afterTomorrow.setDate(tomorrow.getDate()+1),$scope.events=[{date:tomorrow,status:"full"},{date:afterTomorrow,status:"partially"}],$scope.getDayClass=function(date,mode){if("day"===mode)for(var dayToCheck=new Date(date).setHours(0,0,0,0),i=0;i<$scope.events.length;i++){var currentDay=new Date($scope.events[i].date).setHours(0,0,0,0);if(dayToCheck===currentDay)return $scope.events[i].status}return""}}function TimepickerDemoCtrl($scope){$scope.mytime=new Date,$scope.hstep=1,$scope.mstep=15,$scope.options={hstep:[1,2,3],mstep:[1,5,10,15,25,30]},$scope.ismeridian=!0,$scope.toggleMode=function(){return $scope.ismeridian=!$scope.ismeridian},$scope.update=function(){var d;return d=new Date,d.setHours(14),d.setMinutes(0),$scope.mytime=d},$scope.changed=function(){return console.log("Time changed to: "+$scope.mytime)},$scope.clear=function(){return $scope.mytime=null}}function TypeaheadCtrl($scope){$scope.selected=void 0,$scope.states=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Dakota","North Carolina","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"]}function RatingDemoCtrl($scope){$scope.rate=7,$scope.max=10,$scope.isReadonly=!1,$scope.hoveringOver=function(value){return $scope.overStar=value,$scope.percent=100*(value/$scope.max)},$scope.ratingStates=[{stateOn:"glyphicon-ok-sign",stateOff:"glyphicon-ok-circle"},{stateOn:"glyphicon-star",stateOff:"glyphicon-star-empty"},{stateOn:"glyphicon-heart",stateOff:"glyphicon-ban-circle"},{stateOn:"glyphicon-heart"},{stateOff:"glyphicon-off"}]}angular.module("app.ui.form").controller("TagsDemoCtrl",["$scope",TagsDemoCtrl]).controller("DatepickerDemoCtrl",["$scope",DatepickerDemoCtrl]).controller("TimepickerDemoCtrl",["$scope",TimepickerDemoCtrl]).controller("TypeaheadCtrl",["$scope",TypeaheadCtrl]).controller("RatingDemoCtrl",["$scope",RatingDemoCtrl]);
}(),function(){"use strict";function uiRangeSlider(){return{restrict:"A",link:function(scope,ele){ele.slider()}}}function uiFileUpload(){return{restrict:"A",link:function(scope,ele){ele.bootstrapFileInput()}}}function uiWizardForm(){return{restrict:"A",link:function(scope,ele){ele.steps()}}}angular.module("app.ui.form").directive("uiRangeSlider",uiRangeSlider).directive("uiFileUpload",uiFileUpload).directive("uiWizardForm",uiWizardForm)}(),function(){"use strict";function formConstraintsCtrl($scope){var original;$scope.form={required:"",minlength:"",maxlength:"",length_rage:"",type_something:"",confirm_type:"",foo:"",email:"",url:"",num:"",minVal:"",maxVal:"",valRange:"",pattern:""},original=angular.copy($scope.form),$scope.revert=function(){return $scope.form=angular.copy(original),$scope.form_constraints.$setPristine()},$scope.canRevert=function(){return!angular.equals($scope.form,original)||!$scope.form_constraints.$pristine},$scope.canSubmit=function(){return $scope.form_constraints.$valid&&!angular.equals($scope.form,original)}}function signinCtrl($scope){var original;$scope.user={email:"",password:""},$scope.showInfoOnSubmit=!1,original=angular.copy($scope.user),$scope.revert=function(){return $scope.user=angular.copy(original),$scope.form_signin.$setPristine()},$scope.canRevert=function(){return!angular.equals($scope.user,original)||!$scope.form_signin.$pristine},$scope.canSubmit=function(){return $scope.form_signin.$valid&&!angular.equals($scope.user,original)},$scope.submitForm=function(){return $scope.showInfoOnSubmit=!0,$scope.revert()}}function signupCtrl($scope){var original;$scope.user={name:"",email:"",password:"",confirmPassword:"",age:""},$scope.showInfoOnSubmit=!1,original=angular.copy($scope.user),$scope.revert=function(){return $scope.user=angular.copy(original),$scope.form_signup.$setPristine(),$scope.form_signup.confirmPassword.$setPristine()},$scope.canRevert=function(){return!angular.equals($scope.user,original)||!$scope.form_signup.$pristine},$scope.canSubmit=function(){return $scope.form_signup.$valid&&!angular.equals($scope.user,original)},$scope.submitForm=function(){return $scope.showInfoOnSubmit=!0,$scope.revert()}}angular.module("app.ui.form.validation").controller("formConstraintsCtrl",["$scope",formConstraintsCtrl]).controller("signinCtrl",["$scope",signinCtrl]).controller("signupCtrl",["$scope",signupCtrl])}(),function(){"use strict";function toggleNavCollapsedMin($rootScope){function link(scope,ele,attrs){var app;app=$("#app"),ele.on("click",function(e){return app.hasClass("nav-collapsed-min")?app.removeClass("nav-collapsed-min"):(app.addClass("nav-collapsed-min"),$rootScope.$broadcast("nav:reset")),e.preventDefault()})}var directive={restrict:"A",link:link};return directive}function collapseNav(){function link(scope,ele,attrs){var $a,$aRest,$app,$lists,$listsRest,$nav,$window,Timer,prevWidth,slideTime,updateClass;slideTime=250,$window=$(window),$lists=ele.find("ul").parent("li"),$lists.append('<i class="ti-angle-down icon-has-ul-h"></i><i class="ti-angle-right icon-has-ul"></i>'),$a=$lists.children("a"),$listsRest=ele.children("li").not($lists),$aRest=$listsRest.children("a"),$app=$("#app"),$nav=$("#nav-container"),$a.on("click",function(event){var $parent,$this;return!($app.hasClass("nav-collapsed-min")||$nav.hasClass("nav-horizontal")&&$window.width()>=768)&&($this=$(this),$parent=$this.parent("li"),$lists.not($parent).removeClass("open").find("ul").slideUp(slideTime),$parent.toggleClass("open").find("ul").stop().slideToggle(slideTime),void event.preventDefault())}),$aRest.on("click",function(event){$lists.removeClass("open").find("ul").slideUp(slideTime)}),scope.$on("nav:reset",function(event){$lists.removeClass("open").find("ul").slideUp(slideTime)}),Timer=void 0,prevWidth=$window.width(),updateClass=function(){var currentWidth;currentWidth=$window.width(),currentWidth<768&&$app.removeClass("nav-collapsed-min"),prevWidth<768&&currentWidth>=768&&$nav.hasClass("nav-horizontal")&&$lists.removeClass("open").find("ul").slideUp(slideTime),prevWidth=currentWidth},$window.resize(function(){var t;clearTimeout(t),t=setTimeout(updateClass,300)})}var directive={restrict:"A",link:link};return directive}function highlightActive(){function toggleNavCollapsedMinCtrl($scope,$element,$attrs,$location){var highlightActive,links,path;links=$element.find("a"),path=function(){return $location.path()},highlightActive=function(links,path){return path="#"+path,angular.forEach(links,function(link){var $li,$link,href;if($link=angular.element(link),$li=$link.parent("li"),href=$link.attr("href"),$li.hasClass("active")&&$li.removeClass("active"),0===path.indexOf(href))return $li.addClass("active")})},highlightActive(links,$location.path()),$scope.$watch(path,function(newVal,oldVal){if(newVal!==oldVal)return highlightActive(links,$location.path())})}var directive={restrict:"A",controller:["$scope","$element","$attrs","$location",toggleNavCollapsedMinCtrl]};return directive}function toggleOffCanvas(){function link(scope,ele,attrs){ele.on("click",function(){return $("#app").toggleClass("on-canvas")})}var directive={restrict:"A",link:link};return directive}angular.module("app.nav").directive("toggleNavCollapsedMin",["$rootScope",toggleNavCollapsedMin]).directive("collapseNav",collapseNav).directive("highlightActive",highlightActive).directive("toggleOffCanvas",toggleOffCanvas)}(),function(){"use strict";function ConfirmCtrl($scope,$uibModalInstance,vm){$scope.vm=vm,$scope.ok=function(){$uibModalInstance.close(!0)},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}function AuthCtrl($scope,$window,$location,LoginService,AppSessionService){$scope.vm={},$scope.vm.username="",$scope.vm.password="",$scope.login=function(){var vm=$scope.vm;LoginService.Login(vm.username,vm.password,function(err,result){return err?void alert(err):void(result&&AppSessionService.SetUserData(result))})},$scope.signup=function(){LoginService.Signup($scope.vm,function(err,result){return err?void alert(err):void(result&&$location.url("/page/signin"))})},$scope.changepassword=function(){LoginService.ChangePassword({CurrentPassword:$scope.vm.CurrentPassword,NewPassword:$scope.vm.Password,ConfirmPassword:$scope.vm.VerifyPassword},function(err,result){return err?void alert(err):void(result&&$location.url("/page/signin"))})},$scope.reset=function(){LoginService.RecoverPassword({Email:$scope.vm.Email},function(err,result){return err?void alert(err):void(result&&$location.url("/page/signin"))})},$scope.unlock=function(){$location.url("/")}}angular.module("app.page").controller("ConfirmCtrl",["$scope","$uibModalInstance","vm",ConfirmCtrl]).controller("AuthCtrl",["$scope","$window","$location","LoginService","AppSessionService",AuthCtrl])}(),function(){"use strict";function customPage(){function customPageCtrl($scope,$element,$location){var addBg,path;path=function(){return $location.path()},addBg=function(path){switch($element.removeClass("body-wide body-err body-lock body-auth"),path){case"/404":case"/page/404":case"/page/500":return $element.addClass("body-wide body-err");case"/page/signin":case"/page/signup":case"/page/forgot-password":return $element.addClass("body-wide body-auth");case"/page/lock-screen":return $element.addClass("body-wide body-lock")}},addBg($location.path()),$scope.$watch(path,function(newVal,oldVal){if(newVal!==oldVal)return addBg($location.path())})}var directive={restrict:"A",controller:["$scope","$element","$location",customPageCtrl]};return directive}angular.module("app.page").directive("customPage",customPage)}(),function(){"use strict";function LoginService(AppConfig,AilService,AppSessionService){return console.info("REST server url=("+AppConfig.restServerUrl+")"),{Login:function(username,password,callback){AilService.UserLogin(btoa(username+":"+password)).then(function(data){console.info(data),data.Success?callback(null,data):data?callback(data.message,null):callback("Unknown error received from service",null)},function(err){callback(err,null)})},Signup:function(item,callback){restApi.postWithHeaders(restApi.niceUrl(AppConfig.restServerUrl,"/api/Account/Signup"),item,{"Content-Type":"application/json"},function(err,data){callback(err,data)})},RecoverPassword:function(item,callback){restApi.postWithHeaders(restApi.niceUrl(AppConfig.restServerUrl,"/api/Account/RecoverPassword"),item,{"Content-Type":"application/json"},function(err,data){callback(err,data)})},ChangePassword:function(item,callback){restApi.postWithHeaders(restApi.niceUrl(AppConfig.restServerUrl,"/api/Account/ChangePassword"),item,{Authorization:"Bearer "+AppSessionService.GetBearerToken(),"Content-Type":"application/json"},function(err,data){callback(err,data)})}}}angular.module("app.page").factory("LoginService",["AppConfig","AilService","AppSessionService",LoginService])}(),function(){"use strict";function MsgEditAndRetryCtrl($scope,AilService,selectedItem,AppSessionService,$uibModalInstance){$scope.vm={},$scope.vm.isJson=!1,$scope.vm.Message=selectedItem,$scope.vm.hasMessagePriv=AppSessionService.HasPriv("message"),$scope.getMessage=function(id){AilService.getMessage(id).then(function(data){try{if($scope.vm.Message=data,0==$scope.vm.Message.Data.length)throw"Blank string";if("{"!=$scope.vm.Message.Data[0]||"{"!=$scope.vm.Message.Data[0])throw"Not Json";var obj=JSON.parse($scope.vm.Message.Data);$scope.vm.Message.Data=JSON.stringify(obj,null,4),$scope.vm.isJson=!0}catch(ex){console.error(ex),$scope.vm.isJson=!1}})},$scope.ok=function(){$uibModalInstance.close($scope.vm.Message)},$scope.okNew=function(){$scope.vm.Message.Id=0,$uibModalInstance.close($scope.vm.Message)},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")},$scope.getMessage($scope.vm.Message.Id)}function MsgEditCtrl($scope,AilService,AppSessionService){$scope.vm={},$scope.vm.contextData="",$scope.vm.args={},$scope.vm.availableScripts=[],$scope.vm.selectedScript=null,$scope.vm.result="",$scope.vm.hasMessagePriv=AppSessionService.HasPriv("message"),$scope.aceLoaded=function(){console.log("aceLoaded")},$scope.execute=function(){if(null!==$scope.vm.selectedScript){var msg={Name:$scope.vm.selectedScript.Name,Source:"AiL Manager",Context:$scope.vm.contextData,Arguments:JSON.stringify($scope.vm.args)};"Event"!==$scope.vm.selectedScript.MessageType&&"EventModule"!==$scope.vm.selectedScript.MessageType||AilService.createMessage(msg).then(function(){$scope.vm.results="message submitted."},function(err){$scope.vm.results=err}),"Endpoint"!==$scope.vm.selectedScript.MessageType&&"EndpointModule"!==$scope.vm.selectedScript.MessageType||AilService.EndPointScriptFormP(msg.Name,$scope.vm.contextData).then(function(data){$scope.vm.results=data},function(err){$scope.vm.results=err})}},$scope.getScripts=function(){AilService.getAllScripts().then(function(data){$scope.vm.availableScripts=[],data.forEach(function(item){"Task"!=item.MessageType&&"TaskModule"!=item.MessageType&&$scope.vm.availableScripts.push(item)})},function(err){alert(err)})},$scope.getScripts()}function MsgCtrl($scope,$filter,$uibModal,$routeParams,AppSessionService,AilService){var init,$ctrl=this;$scope.vm={},$scope.vm.recordList=[],$scope.vm.filteredRecordList=[],$scope.vm.messageTypeFilter="*",$scope.vm.hasMessagePriv=AppSessionService.HasPriv("message"),$scope.vm.recordType=$routeParams.type,$scope.vm.numPerPageOpt=[5,15,25,50,100],$scope.vm.numPerPage=$scope.vm.numPerPageOpt[2],$scope.vm.currentPage=1,$scope.vm.currentPageRecords=[],$scope.vm.selectedMessages=[],$scope.vm.selectedDate=null,$scope.vm.availableMessageTypes=[],$scope.formats=["dd-MMMM-yyyy HH:mm","yyyy/MM/dd","dd.MM.yyyy","shortDate"],$scope.format=$scope.formats[0],$scope.altInputFormats=["M!/d!/yyyy"],$scope.dateOptions={formatYear:"yy",maxDate:new Date,minDate:new Date(2017,1,1),startingDay:1},$scope.open1=function(){$scope.popup1.opened=!0},$scope.popup1={opened:!1},$scope.popup2={opened:!1},$scope.vm.recordType||($scope.vm.recordType="active"),$scope.invokeEditAndRetry=function(itm){var modalInstance=$uibModal.open({animation:$ctrl.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/msg/messageEditAndRetry.html",controller:"MsgEditAndRetryCtrl",controllerAs:"$ctrl",resolve:{selectedItem:function(){return itm}}});modalInstance.result.then(function(selectedItem){var appSession=AppSessionService.GetUserData();$ctrl.selected=selectedItem,null!=appSession?$ctrl.selected.OperatorId=appSession.Id:$ctrl.selected.OperatorId=0;var msg=$ctrl.selected;AilService.createMessage({Id:msg.Id,Name:msg.Name,Source:msg.Source,Context:msg.Data,Arguments:msg.Arguments,UserDefinedKey:msg.UserDefinedKey}).then(function(){$scope.findRecords()})},function(){console.info("Modal dismissed at: "+new Date)})},$scope.toggleAllSelection=function(opt){1==opt?($scope.vm.selectedMessages=[],$scope.vm.filteredRecordList.forEach(function(itm){$scope.vm.selectedMessages.push(itm.Id)})):$scope.vm.selectedMessages=[]},$scope.onCheckClick=function(id){alert(id)},$scope.toggleSelection=function(id){var idx=$scope.vm.selectedMessages.indexOf(id);idx>-1?$scope.vm.selectedMessages.splice(idx,1):$scope.vm.selectedMessages.push(id)},$scope.select=function(page){var end,start;return start=(page-1)*$scope.vm.numPerPage,end=start+$scope.vm.numPerPage,$scope.vm.currentPageRecords=$scope.vm.filteredRecordList.slice(start,end)},$scope.onFilterChange=function(){return $scope.select(1),$scope.vm.currentPage=1,$scope.vm.row=""},$scope.onNumPerPageChange=function(){return $scope.select(1),$scope.vm.currentPage=1},$scope.onOrderChange=function(){return $scope.select(1),$scope.vm.currentPage=1},$scope.resetStatus=function(status){AilService.setMessageListState({Status:status,IdList:$scope.vm.selectedMessages}).then(function(data){$scope.findRecords()},function(err){alert(err)})},$scope.search=function(){$scope.vm.filteredRecordList=$filter("filter")($scope.vm.recordList,$scope.vm.searchKeywords);var frl=[];return"*"!=$scope.vm.messageTypeFilter&&($scope.vm.filteredRecordList.forEach(function(itm){itm.Name==$scope.vm.messageTypeFilter&&frl.push(itm)}),$scope.vm.filteredRecordList=frl),$scope.onFilterChange()},$scope.order=function(rowName){if($scope.vm.row!==rowName)return $scope.vm.row=rowName,$scope.vm.filteredRecordList=$filter("orderBy")($scope.vm.recordList,rowName),$scope.onOrderChange()},$scope.findRecords=function(){var cutoffDate=moment($scope.vm.selectedDate).format("MM/DD/YYYY HH:mm");AilService.getMessages($scope.vm.recordType,cutoffDate).then(function(data){data.forEach(function(item){if(item.Arguments){var ar=JSON.parse(item.Arguments);item.Q=ar.TargetQueueName}else item.Q=null;$scope.vm.availableMessageTypes.indexOf(item.Name)==-1&&$scope.vm.availableMessageTypes.push(item.Name)}),$scope.vm.recordList=data,$scope.search()},function(err){alert(err)})},$scope.cancelQueue=function(q){},$scope.cancelMessage=function(msg){},(init=function(){$scope.findRecords()})()}angular.module("app").controller("MsgCtrl",["$scope","$filter","$uibModal","$routeParams","AppSessionService","AilService",MsgCtrl]).controller("MsgEditCtrl",["$scope","AilService","AppSessionService",MsgEditCtrl]).controller("MsgEditAndRetryCtrl",["$scope","AilService","selectedItem","AppSessionService","$uibModalInstance",MsgEditAndRetryCtrl])}(),function(){"use strict";function QueuesCtrl($scope,$filter,$uibModal,$routeParams,AppSessionService,AilService){var init,$ctrl=this;$ctrl.animationsEnabled=!0,$scope.vm={},$scope.vm.queueList=[],$scope.vm.expiredQueues=[],$scope.vm.hasMessagePriv=AppSessionService.HasPriv("message"),$scope.modalPopup=function(template){var modal=$uibModal.open({templateUrl:template,scope:$scope});return $scope.modalInstance=modal,modal.result},$scope.cancelQueue=function(itm){$scope.modalPopup("blocks/modal/dialogCancelQueue.html").then(function(data){AilService.CancelQueue({QueueName:itm.Name,CancelledBy:"Dashboard User"}).then(function(data){$scope.getQueues()},function(err){alert(err)})}).then(null,function(reason){})},$scope.cancelMessage=function(itm){$scope.modalPopup("blocks/modal/dialogCancelMessage.html").then(function(data){AilService.Cancel({Id:itm.Id,CancelledBy:"Dashboard User"}).then(function(data){$scope.getQueues()},function(err){alert(err)})}).then(null,function(reason){})},$scope.yes=function(){$scope.modalInstance.close("Yes Button Clicked")},$scope.no=function(){$scope.modalInstance.dismiss("No Button Clicked")},$scope.clearLock=function(itm,resetMsgList){$scope.vm.hasMessagePriv===!0?AilService.ClearQueueLock({QueueName:itm,Reset:resetMsgList}).then(function(data){$scope.getQueues()},function(err){alert(err)}):alert('Must be logged in or have "message" privilege')},$scope.getQueues=function(){AilService.getQueues().then(function(data){$scope.vm.queueList=data},function(err){alert(err)}),AilService.getExpiredQueues().then(function(data){$scope.vm.expiredQueues=data},function(err){alert(err)})},(init=function(){$scope.getQueues()})()}angular.module("app").controller("QueuesCtrl",["$scope","$filter","$uibModal","$routeParams","AppSessionService","AilService",QueuesCtrl])}(),function(){"use strict";function StateNewCtrl($scope,$uibModalInstance){$scope.vm={},$scope.vm.Item=null,$scope.vm.StateValue=null,$scope.ok=function(){$uibModalInstance.close($scope.vm)},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}function StatesCtrl($scope,$filter,$uibModal,$routeParams,AppSessionService,AilService){var init,$ctrl=this;$scope.vm={},$scope.vm.recordList=[],$scope.vm.filteredRecordList=[],$scope.vm.recordType=$routeParams.type,$scope.vm.numPerPageOpt=[5,15,25,50,100],$scope.vm.numPerPage=$scope.vm.numPerPageOpt[2],$scope.vm.currentPage=1,$scope.vm.currentPageRecords=[],$scope.vm.hasMessagePriv=AppSessionService.HasPriv("message"),$scope.vm.searchItem=null,$scope.vm.searchValue=null,$scope.vm.recordType||($scope.vm.recordType="active"),$scope.select=function(page){var end,start;return start=(page-1)*$scope.vm.numPerPage,end=start+$scope.vm.numPerPage,$scope.vm.currentPageRecords=$scope.vm.filteredRecordList.slice(start,end)},$scope.onFilterChange=function(){return $scope.select(1),$scope.vm.currentPage=1,$scope.vm.row=""},$scope.onNumPerPageChange=function(){return $scope.select(1),$scope.vm.currentPage=1},$scope.onOrderChange=function(){return $scope.select(1),$scope.vm.currentPage=1},$scope.search=function(){return $scope.vm.filteredRecordList=$filter("filter")($scope.vm.recordList,$scope.vm.searchKeywords),$scope.onFilterChange()},$scope.newState=function(){var modalInstance=$uibModal.open({animation:$ctrl.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/states/stateNew.html",controller:"StateNewCtrl",controllerAs:"$ctrl"});modalInstance.result.then(function(itm){console.log(itm),AilService.getOrGetState(itm).then(function(){$scope.findRecords()})})},$scope.deleteState=function(itm){console.log(itm);var modalInstance=$uibModal.open({animation:$ctrl.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/page/confirm.html",controller:"ConfirmCtrl",controllerAs:"$ctrl",resolve:{vm:function(){return{Header:"Delete State",SubHeader:"About to remove state from table",Message:"Key = "+itm.Item+" Value = "+itm.StateValue+".  Continue ?"}}}});modalInstance.result.then(function(returnResult){console.info(returnResult),AilService.deleteState(itm).then(function(){$scope.findRecords()})})},$scope.order=function(rowName){if($scope.vm.row!==rowName)return $scope.vm.row=rowName,$scope.vm.filteredRecordList=$filter("orderBy")($scope.vm.recordList,rowName),$scope.onOrderChange()},$scope.findRecords=function(){AilService.findStates($scope.vm.searchItem,$scope.vm.searchValue).then(function(data){$scope.vm.recordList=data,$scope.search()},function(err){alert(err)})},$scope.cancelQueue=function(q){},$scope.cancelMessage=function(msg){},(init=function(){$scope.findRecords()})()}angular.module("app").controller("StateNewCtrl",["$scope","AppSessionService","$uibModalInstance",StateNewCtrl]).controller("StatesCtrl",["$scope","$filter","$uibModal","$routeParams","AppSessionService","AilService",StatesCtrl])}(),function(){"use strict";function LogsCtrl($scope,$filter,$uibModal,$routeParams,AppSessionService,AilService){var init;$scope.vm={},$scope.vm.recordList=[],$scope.vm.filteredRecordList=[],$scope.vm.recordType=$routeParams.type,$scope.vm.numPerPageOpt=[5,15,25,50,100],$scope.vm.numPerPage=$scope.vm.numPerPageOpt[2],$scope.vm.currentPage=1,$scope.vm.currentPageRecords=[],$scope.vm.recordType||($scope.vm.recordType="active"),$scope.select=function(page){var end,start;return start=(page-1)*$scope.vm.numPerPage,end=start+$scope.vm.numPerPage,$scope.vm.currentPageRecords=$scope.vm.filteredRecordList.slice(start,end)},$scope.onFilterChange=function(){return $scope.select(1),$scope.vm.currentPage=1,$scope.vm.row=""},$scope.onNumPerPageChange=function(){return $scope.select(1),$scope.vm.currentPage=1},$scope.onOrderChange=function(){return $scope.select(1),$scope.vm.currentPage=1},$scope.search=function(){return $scope.vm.filteredRecordList=$filter("filter")($scope.vm.recordList,$scope.vm.searchKeywords),$scope.onFilterChange()},$scope.order=function(rowName){if($scope.vm.row!==rowName)return $scope.vm.row=rowName,$scope.vm.filteredRecordList=$filter("orderBy")($scope.vm.recordList,rowName),$scope.onOrderChange()},$scope.findRecords=function(){AilService.getLogMessages(null,null).then(function(data){$scope.vm.recordList=data,$scope.search()},function(err){alert(err)})},$scope.cancelQueue=function(q){},$scope.cancelMessage=function(msg){},(init=function(){$scope.findRecords()})()}angular.module("app").controller("LogsCtrl",["$scope","$filter","$uibModal","$routeParams","AppSessionService","AilService",LogsCtrl])}(),function(){"use strict";function PublishScriptCtrl($scope){}function ExecuteScriptCtrl($scope){}function ScriptsCtrl($scope,$filter,$rootScope,$uibModal,$routeParams,$location,AppSessionService,AilService){var init,$ctrl=this;$ctrl.animationsEnabled=!0,$rootScope.$on("$serverNodeChanged",function(){$scope.getScripts()}),$scope.vm={},$scope.vm.scriptList=[],$scope.vm.recordType=$routeParams.type,$scope.vm.recordTypeAsModule=$routeParams.type+"Module",$scope.vm.showTaskCtrls="Task"==$routeParams.type,$scope.modalPopup=function(template){var modal=$uibModal.open({templateUrl:template,scope:$scope});return $scope.modalInstance=modal,modal.result},$scope.resumeRunState=function(itm){AilService.startTask(itm.Name).then(function(data){console.log(data),itm.IsPaused=!1},function(err){alert(err)})},$scope.pauseRunState=function(itm){AilService.pauseTask(itm.Name).then(function(data){console.log(data),itm.IsPaused=!0},function(err){alert(err)})},$scope.modifyScript=function(item){$location.path("script/scriptEditor").search({Id:item.Id})},$scope.getScripts=function(){AilService.getAllScripts().then(function(data){$scope.vm.scriptList=[],data.forEach(function(itm){itm.MessageType!=$scope.vm.recordType&&itm.MessageType!=$scope.vm.recordTypeAsModule||(itm.hasError=itm.CompileErrors.length>0,$scope.vm.scriptList.push(itm))})},function(err){alert(err)})},(init=function(){$scope.getScripts()})()}function ScriptEditorCtrl($scope,$filter,$uibModal,$routeParams,AppSessionService,AilService){var init,$ctrl=this;$scope.vm={},$scope.vm.script=null,$scope.vm.errorMessage="",$scope.vm.hasError=!1,$scope.aceEditor=null,$ctrl.Id=$routeParams.Id,$scope.aceLoaded=function(_editor){$scope.aceEditor=_editor,$scope.aceEditor.setOptions({enableSnippets:!0})},$scope.invokeTask=function(){var modalInstance=$uibModal.open({animation:$ctrl.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/script/scriptExecute.html",controller:"ExecuteScriptCtrl",controllerAs:"$ctrl",resolve:{selectedItem:function(){return $ctrl.Id}}});modalInstance.result.then(function(selectedItem){var appSession=AppSessionService.GetUserData();$ctrl.selected=selectedItem,$ctrl.selected.OperatorId=appSession.Id,$ctrl.selected["delete"]&&($ctrl.selected.OverrideValue=null),console.log(JSON.stringify($ctrl.selected)),console.log(appSession),AilService.EndPointScriptFormP("Enp_SetDataSource",$ctrl.selected).then(function(data){data.Success?(alert("Record updated"),$scope.refreshDataSource()):alert("Error: "+data.Message)})},function(){console.info("Modal dismissed at: "+new Date)})},$scope.setEnableOrDisable=function(scriptName,enableItem){enableItem?AilService.enableScript(scriptName,enableItem).then(function(data){console.log(data),$scope.vm.script.Active=1},function(err){alert(err)}):AilService.disableScript(scriptName,enableItem).then(function(data){console.log(data),$scope.vm.script.Active=0},function(err){alert(err)})},$scope.publishScript=function(){AilService.CompileScript($scope.vm.script.Name,$scope.vm.script).then(function(data){console.log(data),$scope.vm.hasError=data.Error,$scope.vm.errorMessage=data.Message,$scope.vm.hasError||alert("Script compiled successfully!")},function(err){alert(err)})},$scope.getScript=function(id){AilService.getScript(id).then(function(data){$scope.vm.script=data,$scope.vm.scriptOptions=JSON.parse($scope.vm.script.Configuration),$scope.vm.editorMode=1==$scope.vm.scriptOptions.Language?"vbscript":"csharp",$scope.aceEditor.getSession().setMode("ace/mode/"+$scope.vm.editorMode)},function(err){alert(err)})},$ctrl.okPublish=function(){alert("okPublish")},$ctrl.cancelPublish=function(){alert("cancelPublish")},$scope.openPublisher=function(){$ctrl.selectedItem=$scope.vm.script;var modalInstance=$uibModal.open({animation:$ctrl.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/script/scriptPublish.html",controller:"PublishScriptCtrl",controllerAs:"$ctrl",resolve:{selectedItem:function(){return $ctrl.selectedItem}}});modalInstance.result.then(function(selectedItem){var appSession=AppSessionService.GetUserData();$ctrl.selected=selectedItem,$ctrl.selected.OperatorId=appSession.Id,$ctrl.selected["delete"]&&($ctrl.selected.OverrideValue=null),console.log(JSON.stringify($ctrl.selected)),console.log(appSession),AilService.EndPointScriptFormP("Enp_SetDataSource",$ctrl.selected).then(function(data){data.Success?(alert("Record updated"),$scope.refreshDataSource()):alert("Error: "+data.Message)})},function(){console.info("Modal dismissed at: "+new Date)})},(init=function(){$scope.getScript($ctrl.Id)})()}function ScriptStatusCtrl($scope,$filter,$uibModal,$routeParams,AppSessionService,AilService){var init,$ctrl=this;$scope.vm={},$scope.vm.script=null,$scope.vm.errorMessage="",$scope.vm.hasError=!1,$scope.aceEditor=null,$ctrl.Id=$routeParams.Id,$scope.getScript=function(id){AilService.getScript(id).then(function(data){$scope.vm.script=data,$scope.vm.scriptOptions=JSON.parse($scope.vm.script.Configuration),$scope.vm.hasError=$scope.vm.script.CompileErrors.length>0},function(err){alert(err)})},(init=function(){$scope.getScript($ctrl.Id)})()}angular.module("app").controller("ScriptsCtrl",["$scope","$filter","$rootScope","$uibModal","$routeParams","$location","AppSessionService","AilService",ScriptsCtrl]).controller("ScriptEditorCtrl",["$scope","$filter","$uibModal","$routeParams","AppSessionService","AilService",ScriptEditorCtrl]).controller("ScriptStatusCtrl",["$scope","$filter","$uibModal","$routeParams","AppSessionService","AilService",ScriptStatusCtrl]).controller("PublishScriptCtrl",["$scope",PublishScriptCtrl]).controller("ExecuteScriptCtrl",["$scope",ExecuteScriptCtrl])}(),function(){"use strict";function NotificationsCtrl($scope,AilService,AppSessionService){var init,$ctrl=this;$ctrl.animationsEnabled=!0,$scope.vm={},$scope.vm.EmailConfiguration={},$scope.testEmail=function(){$scope.vm.TestEmail=!0,$scope.saveSettings()},$scope.testSMS=function(){$scope.vm.TestSms=!0,$scope.saveSettings()},$scope.saveSettings=function(){AilService.setNotifications($scope.vm).then(function(data){console.log(data),$scope.vm=data,null==data.ResultMessage||""==data.ResultMessage?alert("Test returned no errors"):(console.error(data.ResultMessage),alert("Test Error: "+data.ResultMessage))},function(err){alert(err)})},$scope.getNotifications=function(){AilService.getNotifications().then(function(data){console.log(data),$scope.vm=null,$scope.vm={},$scope.vm=data},function(err){alert(err)})},(init=function(){$scope.getNotifications()})()}angular.module("app").controller("NotificationsCtrl",["$scope","AilService","AppSessionService",NotificationsCtrl])}();